<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–∞—Ñ–∏—è | –ò–≥—Ä–∞ —Å –¥—Ä—É–∑—å—è–º–∏</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-dark: #1a1a2e;
            --primary-blue: #16213e;
            --accent-red: #e94560;
            --accent-cyan: #0fcec9;
            --accent-yellow: #ffd369;
            --light-bg: #f0f5ff;
            --text-light: #eeeeee;
            --shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
            --radius: 15px;
            --transition: all 0.3s ease;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        body {
            background: linear-gradient(135deg, var(--primary-dark), var(--primary-blue));
            color: var(--text-light);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }
        .page { display: none; min-height: 90vh; }
        .page.active { display: block; animation: fadeIn 0.5s; }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .card {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: var(--radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 25px;
        }
        h1 { font-size: 3rem; text-align: center; margin-bottom: 10px; color: var(--accent-yellow); text-shadow: 0 0 10px rgba(255, 211, 105, 0.5); }
        h2 { color: var(--accent-cyan); margin-bottom: 20px; border-bottom: 2px solid; padding-bottom: 8px; }
        h3 { color: var(--accent-yellow); margin: 15px 0; }
        button {
            background: linear-gradient(to right, var(--accent-cyan), #2af8c7);
            color: var(--primary-dark);
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 5px;
            box-shadow: 0 5px 15px rgba(15, 206, 201, 0.4);
        }
        button:hover { transform: translateY(-3px); box-shadow: 0 8px 20px rgba(15, 206, 201, 0.6); }
        button:active { transform: translateY(1px); }
        button.danger { background: linear-gradient(to right, var(--accent-red), #ff6b8b); box-shadow: 0 5px 15px rgba(233, 69, 96, 0.4); }
        button.secondary { background: rgba(255, 255, 255, 0.1); color: var(--text-light); box-shadow: none; }
        input, select {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            background: rgba(0, 0, 0, 0.3);
            color: white;
            font-size: 1rem;
            margin: 10px 0;
            transition: var(--transition);
        }
        input:focus { outline: none; border-color: var(--accent-cyan); box-shadow: 0 0 10px rgba(15, 206, 201, 0.5); }
        .avatar-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)); gap: 15px; margin: 20px 0; }
        .avatar-option {
            width: 70px; height: 70px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            font-size: 2rem; background: rgba(255, 255, 255, 0.1); cursor: pointer; transition: var(--transition); border: 3px solid transparent;
        }
        .avatar-option:hover { transform: scale(1.1); background: rgba(15, 206, 201, 0.3); }
        .avatar-option.selected { border-color: var(--accent-yellow); background: rgba(255, 211, 105, 0.2); transform: scale(1.05); }
        .room-code { font-size: 4rem; font-weight: bold; letter-spacing: 10px; text-align: center; color: var(--accent-yellow);
            background: rgba(0, 0, 0, 0.4); padding: 20px; border-radius: var(--radius); margin: 20px 0; text-shadow: 0 0 10px; }
        .player-list { display: flex; flex-wrap: wrap; gap: 20px; margin: 25px 0; }
        .player-card {
            background: rgba(255, 255, 255, 0.05); border-radius: var(--radius); padding: 20px; min-width: 200px; flex-grow: 1;
            display: flex; align-items: center; position: relative; transition: var(--transition); border: 2px solid transparent;
        }
        .player-card:hover { border-color: rgba(255, 255, 255, 0.2); transform: translateY(-5px); }
        .player-card.admin { border-left: 5px solid var(--accent-yellow); }
        .player-avatar { font-size: 2.5rem; margin-right: 15px; }
        .player-info { flex-grow: 1; }
        .player-name { font-weight: bold; font-size: 1.2rem; }
        .player-role { font-size: 0.9rem; opacity: 0.8; }
        .mic-indicator {
            width: 20px; height: 20px; border-radius: 50%; margin-left: 10px; transition: var(--transition);
        }
        .mic-on { background-color: #2ecc71; box-shadow: 0 0 10px #2ecc71; }
        .mic-off { background-color: #e74c3c; }
        .mic-admin-off { background-color: #f39c12; }
        .admin-badge { color: var(--accent-yellow); margin-left: 10px; }
        .dropdown-menu { position: absolute; right: 10px; top: 10px; }
        .dropdown-btn { background: none; border: none; color: white; font-size: 1.5rem; padding: 5px; box-shadow: none; }
        .dropdown-content {
            display: none; position: absolute; right: 0; background: var(--primary-blue); min-width: 200px; border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.5); z-index: 100; overflow: hidden;
        }
        .dropdown-content button { width: 100%; border-radius: 0; margin: 0; justify-content: flex-start; background: transparent; box-shadow: none; text-align: left; }
        .dropdown-content button:hover { background: rgba(255,255,255,0.1); }
        .dropdown-menu:hover .dropdown-content { display: block; }
        .chat-box { height: 300px; overflow-y: auto; border: 1px solid rgba(255,255,255,0.1); border-radius: 10px; padding: 15px; margin: 20px 0; background: rgba(0,0,0,0.2); }
        .message { margin-bottom: 12px; padding: 10px; border-radius: 10px; background: rgba(255,255,255,0.05); }
        .message .sender { font-weight: bold; color: var(--accent-cyan); }
        .chat-input { display: flex; gap: 10px; }
        .chat-input input { flex-grow: 1; margin: 0; }
        .game-area { display: grid; grid-template-columns: 2fr 1fr; gap: 25px; }
        .players-board { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
        .game-player-card {
            background: rgba(255,255,255,0.05); border-radius: var(--radius); padding: 20px; text-align: center;
            transition: var(--transition); cursor: pointer; position: relative; border: 3px solid transparent;
        }
        .game-player-card.voted { border-color: var(--accent-red); }
        .game-player-card.selected { border-color: var(--accent-cyan); }
        .game-player-card.dead { opacity: 0.4; filter: grayscale(0.8); }
        .game-log { height: 400px; overflow-y: auto; }
        .log-entry { padding: 10px; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 0.9rem; }
        .log-entry.night { color: #a29bfe; }
        .log-entry.day { color: #ffeaa7; }
        .log-entry.death { color: var(--accent-red); }
        .phase-indicator {
            padding: 20px; text-align: center; border-radius: var(--radius); margin: 20px 0; font-size: 1.5rem; font-weight: bold;
            background: linear-gradient(90deg, #0984e3, #00cec9); animation: pulse 2s infinite;
        }
        .phase-indicator.night { background: linear-gradient(90deg, #2d3436, #6c5ce7); }
        .timer { font-size: 3rem; text-align: center; font-weight: bold; margin: 20px 0; color: var(--accent-yellow); }
        .vote-controls { text-align: center; margin: 30px 0; }
        .role-card {
            padding: 20px; border-radius: var(--radius); margin: 15px 0; background: rgba(0,0,0,0.3);
            border-left: 5px solid; display: none;
        }
        .role-card.visible { display: block; }
        .mafia { border-left-color: var(--accent-red); }
        .sheriff { border-left-color: #3498db; }
        .doctor { border-left-color: #2ecc71; }
        .villager { border-left-color: #f1c40f; }
        .mobile-alert { display: none; padding: 20px; text-align: center; background: var(--accent-red); margin: 20px 0; border-radius: var(--radius); }
        @media (max-width: 768px) {
            .game-area { grid-template-columns: 1fr; }
            .player-card { min-width: 100%; }
            .room-code { font-size: 2.5rem; letter-spacing: 5px; }
            h1 { font-size: 2.2rem; }
            .mobile-alert { display: block; }
        }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(255, 211, 105, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(255, 211, 105, 0); } 100% { box-shadow: 0 0 0 0 rgba(255, 211, 105, 0); } }
        @keyframes nightPulse { 0% { box-shadow: 0 0 0 0 rgba(108, 92, 231, 0.7); } 70% { box-shadow: 0 0 0 20px rgba(108, 92, 231, 0); } 100% { box-shadow: 0 0 0 0 rgba(108, 92, 231, 0); } }
        .night-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(10, 10, 40, 0.95);
            z-index: 1000; display: none; justify-content: center; align-items: center; font-size: 4rem; color: white; flex-direction: column;
            animation: fadeIn 0.8s;
        }
        .night-overlay.active { display: flex; }
    </style>
</head>
<body>
    <div class="mobile-alert">
        <i class="fas fa-mobile-alt"></i> –î–ª—è –ª—É—á—à–µ–≥–æ –æ–ø—ã—Ç–∞ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –ø–æ–≤–µ—Ä–Ω–∏—Ç–µ —ç–∫—Ä–∞–Ω –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ.
    </div>
    <div class="container">
        <h1><i class="fas fa-user-secret"></i> –ú–ê–§–ò–Ø</h1>
        <div id="pageLogin" class="page active">
            <div class="card">
                <h2>–í—Ö–æ–¥ –≤ –∏–≥—Ä—É</h2>
                <p>–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏ –≤—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä:</p>
                <input type="text" id="playerName" placeholder="–í–∞—à–µ –∏–º—è" maxlength="20" value="–ò–≥—Ä–æ–∫">
                <div class="avatar-grid" id="avatarGrid"></div>
                <div style="text-align: center; margin-top: 30px;">
                    <button id="btnCreateRoom"><i class="fas fa-plus-circle"></i> –°–æ–∑–¥–∞—Ç—å –∫–æ–º–Ω–∞—Ç—É</button>
                    <button id="btnJoinRoom" class="secondary"><i class="fas fa-sign-in-alt"></i> –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ</button>
                </div>
            </div>
        </div>
        <div id="pageCreateRoom" class="page">
            <div class="card">
                <h2><i class="fas fa-crown"></i> –í—ã —Å–æ–∑–¥–∞–ª–∏ –∫–æ–º–Ω–∞—Ç—É!</h2>
                <p>–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∫–æ–¥–æ–º –∫–æ–º–Ω–∞—Ç—ã –∏–ª–∏ —Å—Å—ã–ª–∫–æ–π —Å –¥—Ä—É–∑—å—è–º–∏:</p>
                <div class="room-code" id="roomCodeDisplay">ABC123</div>
                <p style="text-align: center; margin-bottom: 20px;">
                    <i class="fas fa-link"></i> –°—Å—ã–ª–∫–∞-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ:<br>
                    <span id="inviteLink" style="color: var(--accent-cyan); word-break: break-all;"></span>
                </p>
                <div style="text-align: center;">
                    <button id="btnCopyLink"><i class="far fa-copy"></i> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
                    <button id="btnGoToLobby" class="secondary"><i class="fas fa-users"></i> –ü–µ—Ä–µ–π—Ç–∏ –≤ –ª–æ–±–±–∏</button>
                </div>
            </div>
        </div>
        <div id="pageJoinRoom" class="page">
            <div class="card">
                <h2><i class="fas fa-door-open"></i> –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –∫–æ–º–Ω–∞—Ç–µ</h2>
                <p>–í–≤–µ–¥–∏—Ç–µ 6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –∫–æ–º–Ω–∞—Ç—ã, –∫ –∫–æ—Ç–æ—Ä–æ–π —Ö–æ—Ç–∏—Ç–µ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è:</p>
                <input type="text" id="inputRoomCode" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: ABC123" maxlength="6" style="text-transform: uppercase; font-size: 1.5rem; text-align: center;">
                <div style="text-align: center;">
                    <button id="btnConnectToRoom"><i class="fas fa-plug"></i> –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è</button>
                    <button id="btnBackToLogin" class="secondary"><i class="fas fa-arrow-left"></i> –ù–∞–∑–∞–¥</button>
                </div>
            </div>
        </div>
        <div id="pageLobby" class="page">
            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                    <h2><i class="fas fa-users"></i> –õ–æ–±–±–∏ –∫–æ–º–Ω–∞—Ç—ã <span id="lobbyRoomCode" style="color: var(--accent-yellow);"></span></h2>
                    <div>
                        <button id="btnStartGame" class="danger"><i class="fas fa-play"></i> –ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
                        <button id="btnLeaveLobby" class="secondary"><i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏</button>
                    </div>
                </div>
                <div class="player-list" id="lobbyPlayerList"></div>
                <div id="adminPanel">
                    <h3><i class="fas fa-user-cog"></i> –ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞</h3>
                    <p>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω—é (‚ãÆ) —Ä—è–¥–æ–º —Å –∏–≥—Ä–æ–∫–æ–º –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.</p>
                </div>
                <h3><i class="fas fa-comments"></i> –ß–∞—Ç –ª–æ–±–±–∏</h3>
                <div class="chat-box" id="lobbyChat"></div>
                <div class="chat-input">
                    <input type="text" id="lobbyChatInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                    <button id="btnSendLobbyMessage"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
        </div>
        <div id="pageGame" class="page">
            <div class="card">
                <div class="phase-indicator" id="phaseIndicator">
                    <i class="fas fa-sun"></i> –î–ï–ù–¨ <span id="phaseTimer">60</span>—Å
                </div>
                <div class="timer" id="gameTimer">60</div>
                <div class="game-area">
                    <div>
                        <h3><i class="fas fa-user-friends"></i> –ò–≥—Ä–æ–∫–∏</h3>
                        <div class="players-board" id="gamePlayersBoard"></div>
                        <div class="vote-controls" id="voteControls">
                            <h3>–ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</h3>
                            <p>–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞, –∑–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å:</p>
                            <button id="btnVote" disabled><i class="fas fa-vote-yea"></i> –ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å</button>
                            <button id="btnSkipVote" class="secondary"><i class="fas fa-forward"></i> –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ</button>
                        </div>
                    </div>
                    <div>
                        <h3><i class="fas fa-scroll"></i> –õ–æ–≥ —Å–æ–±—ã—Ç–∏–π</h3>
                        <div class="game-log" id="gameLog"></div>
                        <div class="role-card" id="playerRoleCard">
                            <h4>–í–∞—à–∞ —Ä–æ–ª—å</h4>
                            <p id="playerRoleText">–ú–∏—Ä–Ω—ã–π –∂–∏—Ç–µ–ª—å</p>
                            <p id="playerRoleDesc">–í—ã ‚Äî —á–µ—Å—Ç–Ω—ã–π –∂–∏—Ç–µ–ª—å –≥–æ—Ä–æ–¥–∞. –í–∞—à–∞ —Ü–µ–ª—å ‚Äî –≤—ã—á–∏—Å–ª–∏—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ—Ö –º–∞—Ñ–∏–æ–∑–∏.</p>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button id="btnEndGame" class="danger"><i class="fas fa-skull-crossbones"></i> –ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="night-overlay" id="nightOverlay">
        <div><i class="fas fa-moon"></i> –ù–û–ß–¨</div>
        <div style="font-size: 1.5rem; margin-top: 20px;" id="nightActionText">–ú–∞—Ñ–∏—è –¥–µ–ª–∞–µ—Ç —Å–≤–æ–π —Ö–æ–¥...</div>
    </div>
    <script>
        // –ò–∫–æ–Ω–∫–∏ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ (Font Awesome)
        const avatarIcons = [
            'fas fa-cat', 'fas fa-dog', 'fas fa-dragon', 'fas fa-fish', 'fas fa-hippo', 'fas fa-otter',
            'fas fa-crow', 'fas fa-dove', 'fas fa-ghost', 'fas fa-robot', 'fas fa-user-astronaut', 'fas fa-hat-wizard'
        ];
        // –ò–≥—Ä–æ–≤—ã–µ —Ä–æ–ª–∏
        const ROLES = {
            VILLAGER: { name: '–ú–∏—Ä–Ω—ã–π –∂–∏—Ç–µ–ª—å', desc: '–í—ã ‚Äî —á–µ—Å—Ç–Ω—ã–π –∂–∏—Ç–µ–ª—å –≥–æ—Ä–æ–¥–∞. –í–∞—à–∞ —Ü–µ–ª—å ‚Äî –≤—ã—á–∏—Å–ª–∏—Ç—å –∏ —É—Å—Ç—Ä–∞–Ω–∏—Ç—å –≤—Å–µ—Ö –º–∞—Ñ–∏–æ–∑–∏.', color: '#f1c40f' },
            MAFIA: { name: '–ú–∞—Ñ–∏—è', desc: '–í—ã ‚Äî —á–ª–µ–Ω –º–∞—Ñ–∏–∏. –ù–æ—á—å—é –≤—ã —É–±–∏–≤–∞–µ—Ç–µ –∂–∏—Ç–µ–ª–µ–π. –í–∞—à–∞ —Ü–µ–ª—å ‚Äî –æ—Å—Ç–∞—Ç—å—Å—è –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ.', color: '#e94560' },
            DOCTOR: { name: '–î–æ–∫—Ç–æ—Ä', desc: '–í—ã ‚Äî –¥–æ–∫—Ç–æ—Ä. –ö–∞–∂–¥—É—é –Ω–æ—á—å –º–æ–∂–µ—Ç–µ –≤—ã–ª–µ—á–∏—Ç—å –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞, –∑–∞—â–∏—Ç–∏–≤ –µ–≥–æ –æ—Ç —É–±–∏–π—Å—Ç–≤–∞.', color: '#2ecc71' },
            SHERIFF: { name: '–®–µ—Ä–∏—Ñ', desc: '–í—ã ‚Äî —à–µ—Ä–∏—Ñ. –ù–æ—á—å—é –º–æ–∂–µ—Ç–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–¥–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –º–∞—Ñ–∏–∏.', color: '#3498db' }
        };
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –∏–≥—Ä—ã
        const GameState = {
            players: [],
            currentPlayerId: null,
            roomCode: null,
            isAdmin: false,
            gamePhase: 'day', // 'day' –∏–ª–∏ 'night'
            gameTime: 60,
            timerInterval: null,
            voteInProgress: false,
            selectedPlayerId: null,
            playerRole: null,
            playerVotes: {},
            microphones: {}, // –°–æ—Å—Ç–æ—è–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–≤: true = –≤–∫–ª—é—á–µ–Ω, false = –≤—ã–∫–ª—é—á–µ–Ω
            chatMessages: []
        };
        // DOM —ç–ª–µ–º–µ–Ω—Ç—ã
        const pages = {
            login: document.getElementById('pageLogin'),
            createRoom: document.getElementById('pageCreateRoom'),
            joinRoom: document.getElementById('pageJoinRoom'),
            lobby: document.getElementById('pageLobby'),
            game: document.getElementById('pageGame')
        };
        const playerNameInput = document.getElementById('playerName');
        const avatarGrid = document.getElementById('avatarGrid');
        const roomCodeDisplay = document.getElementById('roomCodeDisplay');
        const inviteLink = document.getElementById('inviteLink');
        const lobbyRoomCode = document.getElementById('lobbyRoomCode');
        const lobbyPlayerList = document.getElementById('lobbyPlayerList');
        const lobbyChat = document.getElementById('lobbyChat');
        const lobbyChatInput = document.getElementById('lobbyChatInput');
        const gamePlayersBoard = document.getElementById('gamePlayersBoard');
        const gameLog = document.getElementById('gameLog');
        const phaseIndicator = document.getElementById('phaseIndicator');
        const gameTimer = document.getElementById('gameTimer');
        const phaseTimer = document.getElementById('phaseTimer');
        const nightOverlay = document.getElementById('nightOverlay');
        const nightActionText = document.getElementById('nightActionText');
        const playerRoleCard = document.getElementById('playerRoleCard');
        const playerRoleText = document.getElementById('playerRoleText');
        const playerRoleDesc = document.getElementById('playerRoleDesc');
        const btnVote = document.getElementById('btnVote');
        const btnSkipVote = document.getElementById('btnSkipVote');
        let selectedAvatar = 'fas fa-cat';
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∞–≤–∞—Ç–∞—Ä–æ–≤
        avatarIcons.forEach(icon => {
            const div = document.createElement('div');
            div.className = 'avatar-option';
            div.innerHTML = `<i class="${icon}"></i>`;
            div.addEventListener('click', () => {
                document.querySelectorAll('.avatar-option').forEach(el => el.classList.remove('selected'));
                div.classList.add('selected');
                selectedAvatar = icon;
            });
            avatarGrid.appendChild(div);
        });
        document.querySelector('.avatar-option').click();
        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –∫–æ–º–Ω–∞—Ç—ã
        function generateRoomCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let code = '';
            for (let i = 0; i < 6; i++) {
                code += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return code;
        }
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü
        function showPage(pageId) {
            Object.values(pages).forEach(page => page.classList.remove('active'));
            document.getElementById(pageId).classList.add('active');
            if (pageId === 'pageLobby') {
                updateLobby();
                loadFromStorage();
            }
        }
        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ LocalStorage
        function saveToStorage() {
            const data = {
                players: GameState.players,
                roomCode: GameState.roomCode,
                isAdmin: GameState.isAdmin,
                currentPlayerId: GameState.currentPlayerId,
                microphones: GameState.microphones,
                chatMessages: GameState.chatMessages
            };
            localStorage.setItem('mafiaRoomData', JSON.stringify(data));
        }
        // –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ LocalStorage
        function loadFromStorage() {
            const data = JSON.parse(localStorage.getItem('mafiaRoomData'));
            if (data) {
                GameState.players = data.players || [];
                GameState.roomCode = data.roomCode;
                GameState.isAdmin = data.isAdmin || false;
                GameState.currentPlayerId = data.currentPlayerId;
                GameState.microphones = data.microphones || {};
                GameState.chatMessages = data.chatMessages || [];
                updateLobby();
            }
        }
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–Ω–æ–ø–æ–∫
        document.getElementById('btnCreateRoom').addEventListener('click', () => {
            const name = playerNameInput.value.trim() || '–ò–≥—Ä–æ–∫';
            GameState.currentPlayerId = Date.now().toString();
            GameState.roomCode = generateRoomCode();
            GameState.isAdmin = true;
            GameState.players = [{
                id: GameState.currentPlayerId,
                name: name,
                avatar: selectedAvatar,
                isAdmin: true,
                role: null,
                isAlive: true,
                votes: 0
            }];
            GameState.microphones[GameState.currentPlayerId] = true;
            roomCodeDisplay.textContent = GameState.roomCode;
            inviteLink.textContent = window.location.origin + window.location.pathname + '#room=' + GameState.roomCode;
            saveToStorage();
            showPage('pageCreateRoom');
        });
        document.getElementById('btnJoinRoom').addEventListener('click', () => {
            showPage('pageJoinRoom');
        });
        document.getElementById('btnBackToLogin').addEventListener('click', () => {
            showPage('pageLogin');
        });
        document.getElementById('btnCopyLink').addEventListener('click', () => {
            navigator.clipboard.writeText(inviteLink.textContent).then(() => {
                alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
            });
        });
        document.getElementById('btnGoToLobby').addEventListener('click', () => {
            lobbyRoomCode.textContent = GameState.roomCode;
            showPage('pageLobby');
            addSystemMessage('–í—ã —Å–æ–∑–¥–∞–ª–∏ –∫–æ–º–Ω–∞—Ç—É. –û–∂–∏–¥–∞–π—Ç–µ –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤...');
        });
        document.getElementById('btnConnectToRoom').addEventListener('click', () => {
            const code = document.getElementById('inputRoomCode').value.trim().toUpperCase();
            if (code.length !== 6) {
                alert('–ö–æ–¥ –∫–æ–º–Ω–∞—Ç—ã –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ 6 —Å–∏–º–≤–æ–ª–æ–≤!');
                return;
            }
            const name = playerNameInput.value.trim() || '–ò–≥—Ä–æ–∫';
            GameState.currentPlayerId = Date.now().toString();
            GameState.roomCode = code;
            GameState.isAdmin = false;
            // –í —Å–∏–º—É–ª—è—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞—ë–º "—Ñ–µ–π–∫–æ–≤—ã—Ö" –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            GameState.players = [
                { id: 'admin1', name: '–ê–¥–º–∏–Ω', avatar: 'fas fa-crown', isAdmin: true, role: null, isAlive: true, votes: 0 },
                { id: GameState.currentPlayerId, name: name, avatar: selectedAvatar, isAdmin: false, role: null, isAlive: true, votes: 0 },
                { id: 'player2', name: '–ê–ª–µ–∫—Å–µ–π', avatar: 'fas fa-dragon', isAdmin: false, role: null, isAlive: true, votes: 0 },
                { id: 'player3', name: '–ú–∞—Ä–∏—è', avatar: 'fas fa-ghost', isAdmin: false, role: null, isAlive: true, votes: 0 }
            ];
            GameState.microphones[GameState.currentPlayerId] = true;
            GameState.microphones['admin1'] = true;
            GameState.microphones['player2'] = true;
            GameState.microphones['player3'] = true;
            saveToStorage();
            lobbyRoomCode.textContent = GameState.roomCode;
            showPage('pageLobby');
            addSystemMessage(`–í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ –∫–æ–º–Ω–∞—Ç–µ –∫–∞–∫ "${name}".`);
        });
        document.getElementById('btnLeaveLobby').addEventListener('click', () => {
            if (confirm('–í—ã–π—Ç–∏ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã?')) {
                GameState.players = [];
                GameState.roomCode = null;
                localStorage.removeItem('mafiaRoomData');
                showPage('pageLogin');
            }
        });
        document.getElementById('btnStartGame').addEventListener('click', startGame);
        document.getElementById('btnSendLobbyMessage').addEventListener('click', sendLobbyMessage);
        lobbyChatInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendLobbyMessage();
        });
        document.getElementById('btnEndGame').addEventListener('click', () => {
            if (confirm('–ó–∞–≤–µ—Ä—à–∏—Ç—å –∏–≥—Ä—É –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –ª–æ–±–±–∏?')) {
                endGame();
            }
        });
        btnVote.addEventListener('click', castVote);
        btnSkipVote.addEventListener('click', () => {
            addLogEntry('–í—ã –ø—Ä–æ–ø—É—Å—Ç–∏–ª–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ.', 'day');
            btnVote.disabled = true;
        });
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–æ–±–±–∏
        function updateLobby() {
            lobbyPlayerList.innerHTML = '';
            GameState.players.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = `player-card ${player.isAdmin ? 'admin' : ''}`;
                playerCard.id = `player-${player.id}`;
                const micState = GameState.microphones[player.id];
                const micClass = micState === false ? 'mic-admin-off' : (micState ? 'mic-on' : 'mic-off');
                playerCard.innerHTML = `
                    <div class="player-avatar"><i class="${player.avatar}"></i></div>
                    <div class="player-info">
                        <div class="player-name">${player.name} ${player.isAdmin ? '<i class="fas fa-crown admin-badge"></i>' : ''}</div>
                        <div class="player-role">${player.role ? ROLES[player.role].name : '–û–∂–∏–¥–∞–Ω–∏–µ...'}</div>
                    </div>
                    <div class="mic-indicator ${micClass}" id="mic-${player.id}"></div>
                    ${GameState.isAdmin && player.id !== GameState.currentPlayerId ? `
                    <div class="dropdown-menu">
                        <button class="dropdown-btn"><i class="fas fa-ellipsis-v"></i></button>
                        <div class="dropdown-content">
                            <button onclick="renamePlayer('${player.id}')"><i class="fas fa-edit"></i> –ò–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫</button>
                            <button onclick="toggleMicrophone('${player.id}')"><i class="fas fa-microphone${GameState.microphones[player.id] ? '' : '-slash'}"></i> ${GameState.microphones[player.id] ? '–í—ã–∫–ª. –º–∏–∫—Ä–æ—Ñ–æ–Ω' : '–í–∫–ª. –º–∏–∫—Ä–æ—Ñ–æ–Ω'}</button>
                            <button onclick="kickPlayer('${player.id}')" class="danger"><i class="fas fa-user-slash"></i> –í—ã–≥–Ω–∞—Ç—å</button>
                        </div>
                    </div>
                    ` : ''}
                `;
                lobbyPlayerList.appendChild(playerCard);
            });
            document.getElementById('adminPanel').style.display = GameState.isAdmin ? 'block' : 'none';
            document.getElementById('btnStartGame').style.display = GameState.isAdmin ? 'inline-flex' : 'none';
            updateChat();
        }
        // –°–∏—Å—Ç–µ–º–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –ª–æ–±–±–∏
        function addSystemMessage(text) {
            GameState.chatMessages.push({
                sender: '–°–∏—Å—Ç–µ–º–∞',
                text: text,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                isSystem: true
            });
            saveToStorage();
            updateChat();
        }
        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–±–±–∏
        function sendLobbyMessage() {
            const text = lobbyChatInput.value.trim();
            if (!text) return;
            const player = GameState.players.find(p => p.id === GameState.currentPlayerId);
            GameState.chatMessages.push({
                sender: player.name,
                text: text,
                time: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                isSystem: false
            });
            lobbyChatInput.value = '';
            saveToStorage();
            updateChat();
        }
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —á–∞—Ç–∞
        function updateChat() {
            lobbyChat.innerHTML = '';
            GameState.chatMessages.forEach(msg => {
                const div = document.createElement('div');
                div.className = 'message';
                div.innerHTML = `<span class="sender" style="color: ${msg.isSystem ? 'var(--accent-yellow)' : 'var(--accent-cyan)'}">${msg.sender}:</span> ${msg.text} <span style="opacity:0.6; float:right;">${msg.time}</span>`;
                lobbyChat.appendChild(div);
            });
            lobbyChat.scrollTop = lobbyChat.scrollHeight;
        }
        // –§—É–Ω–∫—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
        window.renamePlayer = function(playerId) {
            const newName = prompt('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤–æ–µ –∏–º—è –∏–≥—Ä–æ–∫–∞:');
            if (newName && newName.trim()) {
                const player = GameState.players.find(p => p.id === playerId);
                player.name = newName.trim();
                saveToStorage();
                updateLobby();
                addSystemMessage(`–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∏–∑–º–µ–Ω–∏–ª –∏–º—è –∏–≥—Ä–æ–∫–∞ –Ω–∞ "${newName}".`);
            }
        };
        window.toggleMicrophone = function(playerId) {
            GameState.microphones[playerId] = !GameState.microphones[playerId];
            saveToStorage();
            updateLobby();
            addSystemMessage(`–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä ${GameState.microphones[playerId] ? '–≤–∫–ª—é—á–∏–ª' : '–≤—ã–∫–ª—é—á–∏–ª'} –º–∏–∫—Ä–æ—Ñ–æ–Ω –∏–≥—Ä–æ–∫–∞.`);
        };
        window.kickPlayer = function(playerId) {
            if (confirm('–í—ã–≥–Ω–∞—Ç—å –∏–≥—Ä–æ–∫–∞ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã?')) {
                GameState.players = GameState.players.filter(p => p.id !== playerId);
                saveToStorage();
                updateLobby();
                addSystemMessage('–ò–≥—Ä–æ–∫ –±—ã–ª –≤—ã–≥–Ω–∞–Ω –∏–∑ –∫–æ–º–Ω–∞—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º.');
            }
        };
        // –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã
        function startGame() {
            if (GameState.players.length < 3) {
                alert('–î–ª—è –Ω–∞—á–∞–ª–∞ –∏–≥—Ä—ã –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 3 –∏–≥—Ä–æ–∫–∞!');
                return;
            }
            assignRoles();
            GameState.playerRole = GameState.players.find(p => p.id === GameState.currentPlayerId).role;
            playerRoleCard.className = `role-card visible ${GameState.playerRole}`;
            playerRoleText.textContent = ROLES[GameState.playerRole].name;
            playerRoleDesc.textContent = ROLES[GameState.playerRole].desc;
            playerRoleCard.style.borderLeftColor = ROLES[GameState.playerRole].color;
            GameState.gamePhase = 'day';
            GameState.gameTime = 60;
            updateGameInterface();
            showPage('pageGame');
            startGameTimer();
            addLogEntry('–ò–≥—Ä–∞ –Ω–∞—á–∞–ª–∞—Å—å! –ù–∞—Å—Ç—É–ø–∏–ª –¥–µ–Ω—å. –û–±—Å—É–∂–¥–∞–π—Ç–µ –∏ –≤—ã—è–≤–ª—è–π—Ç–µ –º–∞—Ñ–∏—é.', 'day');
            addLogEntry(`–í–∞—à–∞ —Ä–æ–ª—å: ${ROLES[GameState.playerRole].name}.`, 'day');
        }
        // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–µ–π
        function assignRoles() {
            const roles = [];
            const playerCount = GameState.players.length;
            roles.push('MAFIA');
            if (playerCount >= 4) roles.push('DOCTOR');
            if (playerCount >= 5) roles.push('SHERIFF');
            while (roles.length < playerCount) roles.push('VILLAGER');
            for (let i = roles.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [roles[i], roles[j]] = [roles[j], roles[i]];
            }
            GameState.players.forEach((player, index) => {
                player.role = roles[index];
                player.isAlive = true;
                player.votes = 0;
            });
        }
        // –¢–∞–π–º–µ—Ä –∏–≥—Ä—ã
        function startGameTimer() {
            if (GameState.timerInterval) clearInterval(GameState.timerInterval);
            GameState.gameTime = 60;
            updateTimerDisplay();
            GameState.timerInterval = setInterval(() => {
                GameState.gameTime--;
                updateTimerDisplay();
                if (GameState.gameTime <= 0) {
                    clearInterval(GameState.timerInterval);
                    toggleDayNight();
                }
            }, 1000);
        }
        function updateTimerDisplay() {
            gameTimer.textContent = GameState.gameTime;
            phaseTimer.textContent = GameState.gameTime;
        }
        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –¥–µ–Ω—å/–Ω–æ—á—å
        function toggleDayNight() {
            if (GameState.gamePhase === 'day') {
                GameState.gamePhase = 'night';
                nightActionText.textContent = getNightActionText();
                nightOverlay.classList.add('active');
                setTimeout(() => {
                    nightOverlay.classList.remove('active');
                    GameState.gameTime = 45;
                    updateTimerDisplay();
                    phaseIndicator.innerHTML = `<i class="fas fa-moon"></i> –ù–û–ß–¨ <span id="phaseTimer">${GameState.gameTime}</span>—Å`;
                    phaseIndicator.classList.add('night');
                    addLogEntry('–ù–∞—Å—Ç—É–ø–∏–ª–∞ –Ω–æ—á—å. –í—Å–µ –∑–∞—Å—ã–ø–∞—é—Ç. –ü—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è –º–∞—Ñ–∏—è...', 'night');
                    disableAllMicrophones();
                    startGameTimer();
                }, 3000);
            } else {
                GameState.gamePhase = 'day';
                GameState.gameTime = 60;
                updateTimerDisplay();
                phaseIndicator.innerHTML = `<i class="fas fa-sun"></i> –î–ï–ù–¨ <span id="phaseTimer">${GameState.gameTime}</span>—Å`;
                phaseIndicator.classList.remove('night');
                addLogEntry('–ù–∞—Å—Ç—É–ø–∏–ª–æ —É—Ç—Ä–æ. –ì–æ—Ä–æ–¥ –ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è...', 'day');
                enableAllMicrophones();
                startGameTimer();
                simulateNightEvents();
            }
            updateGameInterface();
        }
        function getNightActionText() {
            if (GameState.playerRole === 'MAFIA') return '–í—ã–±–µ—Ä–∏—Ç–µ –∂–µ—Ä—Ç–≤—É...';
            if (GameState.playerRole === 'DOCTOR') return '–í—ã–±–µ—Ä–∏—Ç–µ, –∫–æ–≥–æ –ª–µ—á–∏—Ç—å...';
            if (GameState.playerRole === 'SHERIFF') return '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º–æ–≥–æ...';
            return '–í—ã —Å–ø–∏—Ç–µ...';
        }
        function simulateNightEvents() {
            const mafia = GameState.players.filter(p => p.role === 'MAFIA' && p.isAlive);
            const victims = GameState.players.filter(p => p.role !== 'MAFIA' && p.isAlive);
            if (victims.length > 0 && mafia.length > 0) {
                const victim = victims[Math.floor(Math.random() * victims.length)];
                victim.isAlive = false;
                addLogEntry(`–ù–æ—á—å—é –º–∞—Ñ–∏—è —É–±–∏–ª–∞ ${victim.name}.`, 'death');
            }
        }
        // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞–º–∏
        function disableAllMicrophones() {
            Object.keys(GameState.microphones).forEach(id => {
                GameState.microphones[id] = false;
            });
            updateGameInterface();
        }
        function enableAllMicrophones() {
            Object.keys(GameState.microphones).forEach(id => {
                GameState.microphones[id] = true;
            });
            updateGameInterface();
        }
        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–≤–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function updateGameInterface() {
            gamePlayersBoard.innerHTML = '';
            GameState.players.forEach(player => {
                const card = document.createElement('div');
                card.className = `game-player-card ${!player.isAlive ? 'dead' : ''} ${player.id === GameState.selectedPlayerId ? 'selected' : ''}`;
                if (GameState.playerVotes[player.id]) card.classList.add('voted');
                card.id = `gameplayer-${player.id}`;
                const micState = GameState.microphones[player.id];
                const micClass = micState === false ? 'mic-admin-off' : (micState ? 'mic-on' : 'mic-off');
                card.innerHTML = `
                    <div style="font-size: 2.5rem;"><i class="${player.avatar}"></i></div>
                    <div class="player-name">${player.name}</div>
                    <div class="player-role">${!player.isAlive ? 'üíÄ –£–±–∏—Ç' : (GameState.gamePhase === 'night' && GameState.playerRole === 'MAFIA' && player.role === 'MAFIA' ? '–ú–∞—Ñ–∏—è' : (player.isAlive ? (GameState.gamePhase === 'day' ? '–ì–æ–ª–æ—Å–æ–≤: ' + player.votes : '???') : ''))}</div>
                    <div style="margin-top: 10px;">
                        <div class="mic-indicator ${micClass}" style="margin: 0 auto;"></div>
                    </div>
                `;
                if (player.isAlive && GameState.gamePhase === 'day' && GameState.currentPlayerId !== player.id) {
                    card.style.cursor = 'pointer';
                    card.addEventListener('click', () => selectPlayer(player.id));
                }
                gamePlayersBoard.appendChild(card);
            });
            btnVote.disabled = GameState.selectedPlayerId === null || GameState.gamePhase !== 'day';
        }
        function selectPlayer(playerId) {
            if (GameState.gamePhase !== 'day') return;
            GameState.selectedPlayerId = playerId;
            updateGameInterface();
        }
        function castVote() {
            if (!GameState.selectedPlayerId) return;
            const targetPlayer = GameState.players.find(p => p.id === GameState.selectedPlayerId);
            if (!targetPlayer || !targetPlayer.isAlive) return;
            targetPlayer.votes = (targetPlayer.votes || 0) + 1;
            GameState.playerVotes[GameState.currentPlayerId] = GameState.selectedPlayerId;
            addLogEntry(`–í—ã –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–ª–∏ –∑–∞ ${targetPlayer.name}.`, 'day');
            GameState.selectedPlayerId = null;
            updateGameInterface();
        }
        // –õ–æ–≥ –∏–≥—Ä—ã
        function addLogEntry(text, type = 'day') {
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.innerHTML = `<i class="fas fa-${type === 'night' ? 'moon' : (type === 'death' ? 'skull' : 'sun')}"></i> [${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}] ${text}`;
            gameLog.appendChild(entry);
            gameLog.scrollTop = gameLog.scrollHeight;
        }
        // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏–≥—Ä—ã
        function endGame() {
            clearInterval(GameState.timerInterval);
            GameState.gamePhase = 'day';
            showPage('pageLobby');
            addSystemMessage('–ò–≥—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –í–æ–∑–≤—Ä–∞—Ç –≤ –ª–æ–±–±–∏.');
        }
        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ö—ç—à–∞ URL –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
        window.addEventListener('load', () => {
            const hash = window.location.hash;
            if (hash.includes('room=')) {
                const code = hash.split('=')[1];
                document.getElementById('inputRoomCode').value = code;
                showPage('pageJoinRoom');
            }
        });
    </script>
</body>
</html>